!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e=e||self).Eta={})}(this,(function(e){"use strict";function t(e){var r,n,a=new Error(e);return r=a,n=t.prototype,Object.setPrototypeOf?Object.setPrototypeOf(r,n):r.__proto__=n,a}function r(e,r,n){var a=r.slice(0,n).split(/\n/),o=a.length,i=a[o-1].length+1;throw t(e+=" at line "+o+" col "+i+":\n\n  "+r.split(/\n/)[o-1]+"\n  "+Array(i).join(" ")+"^")}t.prototype=Object.create(Error.prototype,{name:{value:"Eta Error",enumerable:!1}});var n=new Function("return this;")().Promise;function a(e,t,r){for(var n in t)a=t,o=n,Object.prototype.hasOwnProperty.call(a,o)&&(e[n]=t[n]);var a,o;return e}var o={"&":"&amp;","<":"&lt;",'"':"&quot;","'":"&#39;"};function i(e){return o[e]}function s(e,t){var n=[],a=!1,o=0;function i(e,r){if(e){var o=e.replace(/\\|'/g,"\\$&");(o=(o=function(e,t,r,n){var a,o;return"string"==typeof t.autoTrim?a=o=t.autoTrim:Array.isArray(t.autoTrim)&&(a=t.autoTrim[1],o=t.autoTrim[0]),(r||!1===r)&&(a=r),(n||!1===n)&&(o=n),"slurp"===a&&"slurp"===o?e.trim():("_"===a||"slurp"===a?e=String.prototype.trimLeft?e.trimLeft():e.replace(/^[\s\uFEFF\xA0]+/,""):"-"!==a&&"nl"!==a||(e=e.replace(/^(?:\n|\r|\r\n)/,"")),"_"===o||"slurp"===o?e=String.prototype.trimRight?e.trimRight():e.replace(/[\s\uFEFF\xA0]+$/,""):"-"!==o&&"nl"!==o||(e=e.replace(/(?:\n|\r|\r\n)$/,"")),e)}(o,t,a,r)).replace(/\n/g,"\\n").replace(/\r/g,"\\r"))&&n.push(o)}}for(var s,c=(t.parse.exec+t.parse.interpolate+t.parse.raw).split("").join("|"),p=new RegExp("([^]*?)"+t.tags[0]+"(-|_)?\\s*("+c+")?","g"),u=new RegExp("\\s*((?:[^]*?(?:'(?:\\\\[\\s\\w\"'\\\\`]|[^\\n\\r'\\\\])*?'|`(?:\\\\[\\s\\w\"'\\\\`]|[^\\\\`])*?`|\"(?:\\\\[\\s\\w\"'\\\\`]|[^\\n\\r\"\\\\])*?\"|\\/\\*[^]*?\\*\\/)?)*?)\\s*(-|_)?"+t.tags[1],"g");null!==(s=p.exec(e));){o=s[0].length+s.index;var l=s[1],f=s[2],h=s[3]||"";i(l,f),u.lastIndex=o;var g=u.exec(e);if(g){var v=g[1];a=g[2],p.lastIndex=o=u.lastIndex;var m="";h===t.parse.exec?m="e":h===t.parse.raw?m="r":h===t.parse.interpolate&&(m="i"),n.push({t:m,val:v})}else r("unclosed tag",e,o)}if(i(e.slice(o,e.length),!1),t.plugins)for(var y=0;y<t.plugins.length;y++){var d=t.plugins[y];d.processAST&&(n=d.processAST(n,t))}return n}function c(e,t){var r=s(e,t),n="var tR='';"+(t.useWith?"with("+t.varName+"||{}){":"")+function(e,t){var r=0,n=e.length,a="";for(;r<n;r++){var o=e[r];if("string"==typeof o){a+="tR+='"+o+"';"}else{var i=o.t,s=o.val||"";"r"===i?a+="tR+="+s+";":"i"===i?(t.autoEscape&&(s="E.e("+s+")"),a+="tR+="+s+";"):"e"===i&&(a+=s+"\n")}}return a}(r,t)+"if(cb){cb(null,tR)} return tR"+(t.useWith?"}":"");if(t.plugins)for(var a=0;a<t.plugins.length;a++){var o=t.plugins[a];o.processFnString&&(n=o.processFnString(n,t))}return n}var p=new(function(){function e(e){this.cache=e}return e.prototype.define=function(e,t){this.cache[e]=t},e.prototype.get=function(e){return this.cache[e]},e.prototype.remove=function(e){delete this.cache[e]},e.prototype.reset=function(){this.cache={}},e.prototype.load=function(e){a(this.cache,e)},e}())({});function u(e,r){var n=this.templates.get(e);if(!n)throw t('Could not fetch template "'+e+'"');return n(r,this)}var l={varName:"it",autoTrim:[!1,"nl"],autoEscape:!0,tags:["<%","%>"],parse:{interpolate:"=",raw:"~",exec:""},async:!1,templates:p,cache:!1,plugins:[],useWith:!1,e:function(e){var t=String(e);return/[&<"']/.test(t)?t.replace(/[&<"']/g,i):t},include:u};function f(e,t){var r={};return a(r,l),t&&a(r,t),e&&a(r,e),r}function h(e,r){var n,a=f(r||{});if(a.async)try{n=new Function("return (async function(){}).constructor;")()}catch(e){throw e instanceof SyntaxError?t("This environment doesn't support async/await"):e}else n=Function;try{return new n(a.varName,"E","cb",c(e,a))}catch(r){throw r instanceof SyntaxError?t("Bad template syntax\n\n"+r.message+"\n"+Array(r.message.length+1).join("=")+"\n"+c(e,a)):r}}function g(e,t){var r;return t.cache&&t.name&&t.templates.get(t.name)?t.templates.get(t.name):(r="function"==typeof e?e:h(e,t),t.cache&&t.name&&t.templates.define(t.name,r),r)}u.bind(l),e.compile=h,e.compileToString=c,e.defaultConfig=l,e.getConfig=f,e.parse=s,e.render=function(e,r,a,o){var i=f(a||{});if(!i.async)return g(e,i)(r,i);if(!o){if("function"==typeof n)return new n((function(t,n){try{t(g(e,i)(r,i))}catch(e){n(e)}}));throw t("Please provide a callback function, this env doesn't support Promises")}try{g(e,i)(r,i,o)}catch(e){return o(e)}},e.templates=p,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=eta.min.js.map
